{"ast":null,"code":"import _regeneratorRuntime from\"/home/sushilkumar/Desktop/mernappsocial/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/sushilkumar/Desktop/mernappsocial/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/sushilkumar/Desktop/mernappsocial/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";// eslint-disable-next-line\nimport\"./post.css\";import{MoreVert}from\"@material-ui/icons\";import{useContext,useEffect,useState}from\"react\";import axios from\"axios\";import{format}from\"timeago.js\";import{Link}from\"react-router-dom\";import{AuthContext}from\"../../context/AuthContext\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function Post(_ref){var post=_ref.post;var _useState=useState(post.likes.length),_useState2=_slicedToArray(_useState,2),like=_useState2[0],setLike=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),text=_useState4[0],setCommenttext=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isLiked=_useState6[0],setIsLiked=_useState6[1];var _useState7=useState({}),_useState8=_slicedToArray(_useState7,2),user=_useState8[0],setUser=_useState8[1];var PF=process.env.REACT_APP_PUBLIC_FOLDER;var _useContext=useContext(AuthContext),currentUser=_useContext.user;useEffect(function(){setIsLiked(post.likes.includes(currentUser._id));},[currentUser._id,post.likes]);useEffect(function(){var fetchUser=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(\"/api/users?userId=\".concat(post.userId));case 2:res=_context.sent;setUser(res.data);case 4:case\"end\":return _context.stop();}}},_callee);}));return function fetchUser(){return _ref2.apply(this,arguments);};}();fetchUser();},[post.userId]);var likeHandler=function likeHandler(){try{axios.put(\"/api/posts/\"+post._id+\"/like\",{userId:currentUser._id});}catch(err){}setLike(isLiked?like-1:like+1);setIsLiked(!isLiked);};var commentHandler=function commentHandler(){try{axios.put(\"/api/posts/\"+post._id+\"/comment\",{username:currentUser.username,image:currentUser.profilePicture,text:text});window.location.reload();}catch(err){console.log(err);}};/*   const getName= async (id)=>{\n    console.log(\"before matching id\",id);\n    const res = await axios.get(`/users?userId=${id}`);\n    console.log(\"after matching id\",res.data._id)\n    console.log(\"Name\",res.data.username)\n    return (res.data.username);\n  }\n\n  const  getImage= async (id)=>{\n    const res = await axios.get(`/users?userId=${id}`);\n    return res.data.profilePicture;\n  } */return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{class:\" rounded overflow-hidden border w-full lg:w-6/12 md:w-6/12 bg-white mx-3 md:mx-0 lg:mx-0\",children:[/*#__PURE__*/_jsxs(\"div\",{class:\"w-full flex justify-between p-3\",children:[/*#__PURE__*/_jsxs(\"div\",{class:\"flex\",children:[/*#__PURE__*/_jsx(\"div\",{class:\"rounded-full h-8 w-8 bg-gray-500 flex items-center justify-center overflow-hidden\",children:/*#__PURE__*/_jsx(Link,{to:\"/profile/\".concat(user.username),children:/*#__PURE__*/_jsx(\"img\",{className:\"postProfileImg\",src:user.profilePicture?PF+user.profilePicture:PF+\"person/noAvatar.png\",alt:\"\"})})}),/*#__PURE__*/_jsx(\"span\",{class:\"pt-1 ml-2 font-bold text-sm\",children:user.username}),/*#__PURE__*/_jsx(\"span\",{class:\"pt-1 ml-2 font-bold text-sm\",children:format(post.createdAt)})]}),/*#__PURE__*/_jsx(\"span\",{class:\"px-2 hover:bg-gray-300 cursor-pointer rounded\",children:/*#__PURE__*/_jsx(\"i\",{class:\"fas fa-ellipsis-h pt-2 text-lg\"})})]}),post.img!==undefined?/*#__PURE__*/_jsx(\"img\",{class:\"w-full bg-cover\",src:PF+post.img}):\"\",/*#__PURE__*/_jsxs(\"div\",{class:\"px-3 pb-2\",children:[/*#__PURE__*/_jsxs(\"div\",{class:\"pt-2\",children:[/*#__PURE__*/_jsx(\"img\",{className:\"likeIcon\",src:\"\".concat(PF,\"like.png\"),onClick:likeHandler,alt:\"\"}),/*#__PURE__*/_jsx(\"i\",{class:\"far fa-heart cursor-pointer\"}),/*#__PURE__*/_jsxs(\"span\",{class:\"text-sm text-gray-400 font-medium\",children:[like,\" likes\"]})]}),/*#__PURE__*/_jsx(\"div\",{class:\"pt-1\",children:/*#__PURE__*/_jsxs(\"div\",{class:\"mb-2 text-sm\",children:[/*#__PURE__*/_jsx(\"span\",{class:\"font-medium mr-2  font-normal\",children:user.username}),\" \",post===null||post===void 0?void 0:post.desc]})}),/*#__PURE__*/_jsxs(\"div\",{class:\"text-sm mb-2 text-gray-400 cursor-pointer\\t\",children:[\"View all \",post.comment,\" comments\"]}),/*#__PURE__*/_jsxs(\"div\",{class:\"mb-2\",children:[/*#__PURE__*/_jsxs(\"div\",{class:\"mb-2 text-sm\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",class:\"font-medium mr-2\",onChange:function onChange(e){setCommenttext(e.target.value);}}),/*#__PURE__*/_jsx(\"button\",{class:\"bg-transparent hover:bg-blue-500 text-blue-700 font-semibold hover:text-white py-2 px-4 border border-blue-500 hover:border-transparent rounded\",onClick:commentHandler,children:\"Post\"})]}),/*#__PURE__*/_jsx(\"div\",{class:\"mb-2 text-sm\",children:post.comments.map(function(comment){return/*#__PURE__*/_jsxs(\"div\",{className:\"commentArea\",children:[/*#__PURE__*/_jsx(Link,{to:\"/profile/\".concat(comment.name),children:/*#__PURE__*/_jsxs(\"div\",{className:\"profileomment\",children:[/*#__PURE__*/_jsx(\"img\",{src:comment.image?PF+comment.image:PF+\"person/noAvatar.png\",className:\"rounded-full h-8 w-8 bg-gray-500 flex items-center justify-center overflow-hidden\"}),/*#__PURE__*/_jsx(\"span\",{children:comment.name})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"comment\",children:comment.text})]});})})]})]})]})});}","map":{"version":3,"sources":["/home/sushilkumar/Desktop/mernappsocial/client/src/components/post/Post.jsx"],"names":["MoreVert","useContext","useEffect","useState","axios","format","Link","AuthContext","Post","post","likes","length","like","setLike","text","setCommenttext","isLiked","setIsLiked","user","setUser","PF","process","env","REACT_APP_PUBLIC_FOLDER","currentUser","includes","_id","fetchUser","get","userId","res","data","likeHandler","put","err","commentHandler","username","image","profilePicture","window","location","reload","console","log","createdAt","img","undefined","desc","comment","e","target","value","comments","map","name"],"mappings":"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","sourcesContent":["// eslint-disable-next-line\n\nimport \"./post.css\";\nimport { MoreVert } from \"@material-ui/icons\";\nimport { useContext, useEffect, useState } from \"react\";\nimport axios from \"axios\";\nimport { format } from \"timeago.js\";\nimport { Link } from \"react-router-dom\";\nimport { AuthContext } from \"../../context/AuthContext\";\n\nexport default function Post({ post }) {\n  const [like, setLike] = useState(post.likes.length);\n  const [text,setCommenttext]=useState('');\n  const [isLiked, setIsLiked] = useState(false);\n  const [user, setUser] = useState({});\n  const PF = process.env.REACT_APP_PUBLIC_FOLDER;\n  const { user: currentUser } = useContext(AuthContext);\n\n  \n\n  useEffect(() => {\n    setIsLiked(post.likes.includes(currentUser._id));\n  }, [currentUser._id, post.likes]);\n\n  useEffect(() => {\n    const fetchUser = async () => {\n      const res = await axios.get(`/api/users?userId=${post.userId}`);\n      setUser(res.data);\n    };\n    fetchUser();\n  }, [post.userId]);\n\n\n  const likeHandler = () => {\n    try {\n      axios.put(\"/api/posts/\" + post._id + \"/like\", { userId: currentUser._id });\n    } catch (err) { }\n    setLike(isLiked ? like - 1 : like + 1);\n    setIsLiked(!isLiked);\n  };\n\n  const commentHandler = () => {\n    try {\n      axios.put(\"/api/posts/\" + post._id + \"/comment\", { username: currentUser.username ,image:currentUser.profilePicture, text:text});\n      window.location.reload();\n    } catch (err) {\n      console.log(err)\n     }\n\n  };\n\n/*   const getName= async (id)=>{\n    console.log(\"before matching id\",id);\n    const res = await axios.get(`/users?userId=${id}`);\n    console.log(\"after matching id\",res.data._id)\n    console.log(\"Name\",res.data.username)\n    return (res.data.username);\n  }\n\n  const  getImage= async (id)=>{\n    const res = await axios.get(`/users?userId=${id}`);\n    return res.data.profilePicture;\n  } */\n\n  return (\n    <>\n    {\n    }\n      <div class=\" rounded overflow-hidden border w-full lg:w-6/12 md:w-6/12 bg-white mx-3 md:mx-0 lg:mx-0\">\n        <div class=\"w-full flex justify-between p-3\">\n          <div class=\"flex\">\n            <div class=\"rounded-full h-8 w-8 bg-gray-500 flex items-center justify-center overflow-hidden\">\n              <Link to={`/profile/${user.username}`}>\n                <img\n                  className=\"postProfileImg\"\n                  src={\n                    user.profilePicture\n                      ? PF + user.profilePicture\n                      : PF + \"person/noAvatar.png\"\n                  }\n                  alt=\"\"\n                />\n              </Link>\n            </div>\n            <span class=\"pt-1 ml-2 font-bold text-sm\">{user.username}</span>\n            <span class=\"pt-1 ml-2 font-bold text-sm\">{format(post.createdAt)}</span>\n\n          </div>\n          <span class=\"px-2 hover:bg-gray-300 cursor-pointer rounded\"><i class=\"fas fa-ellipsis-h pt-2 text-lg\"></i></span>\n        </div>\n      \n        {post.img !== undefined ? <img class=\"w-full bg-cover\" src={PF + post.img} /> : \"\"}\n        <div class=\"px-3 pb-2\">\n          <div class=\"pt-2\">\n            <img\n              className=\"likeIcon\"\n              src={`${PF}like.png`}\n              onClick={likeHandler}\n              alt=\"\"\n            />\n            <i class=\"far fa-heart cursor-pointer\"></i>\n            <span class=\"text-sm text-gray-400 font-medium\">{like} likes</span>\n          </div>\n          <div class=\"pt-1\">\n            <div class=\"mb-2 text-sm\">\n              <span class=\"font-medium mr-2  font-normal\">{user.username}</span> {post?.desc}\n            </div>\n          </div>\n          <div class=\"text-sm mb-2 text-gray-400 cursor-pointer\t\">View all {post.comment} comments</div>\n          <div class=\"mb-2\">\n            <div class=\"mb-2 text-sm\">\n              <input type=\"text\" class=\"font-medium mr-2\" onChange={(e) =>{setCommenttext(e.target.value)}} />\n              <button class=\"bg-transparent hover:bg-blue-500 text-blue-700 font-semibold hover:text-white py-2 px-4 border border-blue-500 hover:border-transparent rounded\" onClick={commentHandler}>\n              Post\n            </button>\n            </div>\n          \n            <div class=\"mb-2 text-sm\">\n                {post.comments.map((comment) => (  \n                          <div className=\"commentArea\"> \n                          <Link to={`/profile/${comment.name}`}>\n                          <div className=\"profileomment\">\n                            <img src={comment.image?PF+comment.image:PF + \"person/noAvatar.png\"} className=\"rounded-full h-8 w-8 bg-gray-500 flex items-center justify-center overflow-hidden\" />   \n                            <span>{comment.name}</span>  \n                            </div>\n                            </Link>\n                            \n                            <div className=\"comment\">{comment.text}</div>\n                          </div>\n                      ))}\n                    \n                    \n            </div>\n          </div>\n        </div>\n      </div>\n    </>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}